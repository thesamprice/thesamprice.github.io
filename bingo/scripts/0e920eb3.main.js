function DatabaseBuild(){for(var a={},b=1;65>=b;b++)a[b]=0;return database={ver:1,cards:{},numbers_used:a}}function DatabaseSave(){var a=JSON.stringify(database);$.cookie("db",a,{path:"/",expires:365})}function BuildCol(a){var b=document.createElement("select");$(b).attr({"class":"form-control num_input"});var c=row_ranges[a];for(x=c[0];x<=c[1];x++){var d=document.createElement("option");$(d).attr({value:x}),$(d).text(x),$(b).append(d)}return b}function ValidateCardName(){var a=$("#cardname").val();return""==a?(alert('Card name cant be ""'),!1):!0}function ValidateNumbers(){var a=[];for(row=0;5>row;row++)for(col=0;5>col;col++){var b="tr.row-"+row;if(b=b+" td.col-"+col,b+=" select",number=$(b).val(),-1!=$.inArray(number,a))return alert(a),alert(number+" Used More than once"),!1;a.push(number)}return!0}function BuildCard(){var a=Array(5);for(col=0;5>col;col++){var b=Array(5);for(row=0;5>row;row++){var c="tr.row-"+row;c=c+" td.col-"+col,c+=" select";var d=parseInt($(c).val());void 0==d&&(d=-1),b[row]=d}a[col]=b}card_name=$("#cardname").val(),database.cards[card_name]=a,DatabaseSave()}function SelectCardsPopulate(){$("#PageSelect").empty();for(var a in database.cards){var b=document.createElement("div");$(b).text(a);var c=document.createElement("input");$(c).attr({type:"checkbox","data-label":a,"class":"SelectCardCheck"}),$(b).append(c),$("#PageSelect").append(b),$(c).text(a)}}function SelectCurrentCards(){SelectedCards=[],SelectedCardNames=[];var a=$(".SelectCardCheck:checked"),b=a.length;a.each(function(a,c){key=$(c).text(),SelectedCardNames.push(key),SelectedCards.push(database.cards[key]),a==b-1&&PlayModeBuild()})}function PlayBuildCard(a,b){for(html_card=$("#PlayCardDefault").clone(),$(html_card).attr({id:a}).show(),$("#PlayCards").append(html_card),$("#"+a+" h4.PlayCardName").text(a),col=0;5>col;col++)for(row=0;5>row;row++)num=b[col][row],selector="#"+a+" .card-col-"+col+".card-row-"+row,$(selector).addClass("card-num-"+num)}function PlayModeBuild(){$("#PlayCards").empty();var a=Array(5);for(x=0;5>x;x++)a[x]=Array();for(x in SelectedCards)for(card=SelectedCards[x],card_name=SelectedCardNames[x],PlayBuildCard(card_name,card),col=0;5>col;col++)for(row=0;5>row;row++)c=card[col][row],isNaN(c)||-1==$.inArray(c,a[col])&&a[col].push(c);for(col=0;5>col;col++){a[col]=a[col].sort(function(a,b){return a-b});var b="#Play-"+col;$(b).empty();for(i in a[col]){var c=parseInt(a[col][i]);if(!isNaN(c)){var d=document.createElement("div");$(d).text(c),$(d).addClass("PlayCheck");{document.createElement("div")}$(d).click(PlayCheckCallback),$(b).append(d)}}}$(".card-col-2.card-row-2").addClass("cardcellOn"),CalledNumbers=Array()}function PlayCheckCallback(a){var a=$(a.target),b=parseInt(a.text());if(0==a.hasClass("cardcellOn"))-1==$.inArray(b,CalledNumbers)&&(a.addClass("cardcellOn"),CalledNumbers.push(b),$(".card-num-"+b).addClass("cardcellOn"),CheckCards());else{a.removeClass("cardcellOn");var c=CalledNumbers.indexOf(b);c>-1&&CalledNumbers.splice(c,1),$(".card-num-"+b).removeClass("cardcellOn")}}function CheckCards(){var a=!1;for(x in SelectedCards){for(card=SelectedCards[x],card_name=SelectedCardNames[x],col=0;5>col;col++){for(a=!0,query="#"+card_name+" .card-col-"+col,row=0;5>row;row++)if(query2=query+".card-row-"+row,0==$(query2).hasClass("cardcellOn")){a=!1;break}1==a&&alert(card_name+" Col")}for(row=0;5>row;row++){for(a=!0,col=0;5>col;col++)if(query="#"+card_name+" .card-col-"+col,query2=query+".card-row-"+row,0==$(query2).hasClass("cardcellOn")){a=!1;break}if(1==a)return alert(card_name+" Row"),void alert(query2)}var b=[[0,0],[1,1],[3,3],[4,4]];for(a=!0,i=0;4>i;i++)if(col=b[i][0],row=b[i][1],query="#"+card_name+" .card-col-"+col,query2=query+".card-row-"+row,0==$(query2).hasClass("cardcellOn")){a=!1;break}if(1==a)return void alert(card_name+" Diag");var b=[[0,4],[1,3],[3,1],[4,0]];for(a=!0,i=0;4>i;i++)if(col=b[i][0],row=b[i][1],query="#"+card_name+" .card-col-"+col,query2=query+".card-row-"+row,0==$(query2).hasClass("cardcellOn")){a=!1;break}if(1==a)return void alert(card_name+" Diag 2")}}var database=$.cookie("db");void 0==database?(database=DatabaseBuild(),DatabaseSave()):database=JSON.parse(database);var gah=void 0;$("#HeadNav li a").click(function(a){node=a.target,$("#PageEntry").hide(),$("#PageSelect").hide(),$("#PagePlay").hide(),$("#PageStats").hide();var b=$(node).attr("href");$(b).show()});var table=$("#EntryTable"),row_ranges={0:[1,15],1:[16,30],2:[31,45],3:[46,60],4:[61,75]};for(row=0;5>row;row++){var rowEl=document.createElement("tr");for($(rowEl).attr({"class":"row-"+row}),$(table).append(rowEl),col=0;5>col;col++){var colEl=document.createElement("td");$(colEl).attr({"class":"col-"+col});var inputEl=BuildCol(col);$(inputEl).val(row_ranges[col][0]+row),$(inputEl).attr({row:row,col:col}),$(colEl).append(inputEl),$(rowEl).append(colEl)}}$(".row-2 .col-2").text("FREE"),$("#EnterCallback").click(function(){0!=ValidateCardName()&&0!=ValidateNumbers()&&(BuildCard(),SelectCardsPopulate(),alert("Saved card"))}),SelectCardsPopulate();var SelectedCards=[],SelectedCardNames=[];$("#PagePlayHit").click(function(){SelectCurrentCards()});var CalledNumbers=Array();for(row=0;5>row;row++){var rel=document.createElement("tr");for($("#PlayCardDefault .PlayCardTable").append(rel),col=0;5>col;col++){var cel=document.createElement("td");$(rel).append(cel);var classname="cardcell card-col-"+col+" card-row-"+row;$(cel).attr({"class":classname})}}$("#PlayCardDefault").hide();